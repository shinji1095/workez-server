openapi: 3.0.3
info:
  title: 椎茸収穫管理API（仮）
  version: 0.1.0
  description: '椎茸の収穫数をITデバイスで自動集計しWebで可視化するためのAPI仕様書（仮）。

    一次情報はプロジェクト内CSV（01_WEB機能一覧(機能一覧).csv）の「メソッド」「パス」等のみ。

    CSVに無い入出力・認証等は、本OpenAPIで仕様として確定させる。

    '
servers:
- url: http://127.0.0.1:8000
  description: ローカル開発
- url: https://<render-service>.onrender.com
  description: デプロイ環境
tags:
- name: admin
  description: 管理ユーザーに関する機能群
- name: analytics
  description: 収穫数予想や売り上げ予想などの機能群
- name: defects
  description: 不良品に関する機能群
- name: devices
  description: デバイスに関する機能群
- name: harvest
  description: 収穫量を提供する機能群
- name: prices
  description: 単価に関する機能群
- name: users
  description: ユーザーに関する機能群
paths:
  /admin/users/{userId}:
    put:
      tags:
      - admin
      summary: 管理ユーザー権限変更
      description: 'ページ: ユーザー一覧

        権限（CSV記載）: 管理者≧

        '
      operationId: updateAdminUsers
      parameters:
      - $ref: '#/components/parameters/userId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAdminUsersRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateAdminUsersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /analytics/harvest/monthly:
    get:
      tags:
      - analytics
      summary: 月間収穫量予想
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 1か月の収穫量を予測

        '
      operationId: listAnalyticsHarvestMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAnalyticsHarvestMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /analytics/revenue/monthly:
    get:
      tags:
      - analytics
      summary: 月間売上
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 1か月の売り上げ推移

        '
      operationId: listAnalyticsRevenueMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAnalyticsRevenueMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /analytics/revenue/yearly:
    get:
      tags:
      - analytics
      summary: 年間売り上げ
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 年間の売り上げ推移

        '
      operationId: listAnalyticsRevenueYearly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListAnalyticsRevenueYearlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /defects/amount/add:
    post:
      tags:
      - defects
      summary: 不良品数の送信
      description: "ページ: 本日の不良品数の可視化\n権限（CSV記載）: \n説明: デバイスが前回送信以降の差分（インクリメント）をアップロード\nevent_id による冪等性を担保（重複は 409）\n"
      operationId: createDefectsAmountAdd
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDefectsAmountAddRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateDefectsAmountAddResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /defects/amount/monthly:
    get:
      tags:
      - defects
      summary: 月間不良品数
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        '
      operationId: listDefectsAmountMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDefectsAmountMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /defects/amount/weekly:
    get:
      tags:
      - defects
      summary: 週間不良品数
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        '
      operationId: listDefectsAmountWeekly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDefectsAmountWeeklyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /defects/ratio/monthly:
    get:
      tags:
      - defects
      summary: 月間不良品割合
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        '
      operationId: listDefectsRatioMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDefectsRatioMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /defects/ratio/weekly:
    get:
      tags:
      - defects
      summary: 週間不良品割合
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        '
      operationId: listDefectsRatioWeekly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDefectsRatioWeeklyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /devices:
    get:
      tags:
      - devices
      summary: デバイス一覧
      description: 'ページ: デバイス一覧

        権限（CSV記載）: 管理者≧

        '
      operationId: listDevices
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListDevicesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
    post:
      tags:
      - devices
      summary: デバイス登録
      description: 'ページ: デバイス登録

        権限（CSV記載）: 管理者≧

        '
      operationId: createDevices
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDevicesRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateDevicesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /devices/{deviceId}:
    delete:
      tags:
      - devices
      summary: デバイス削除
      description: 'ページ: デバイス一覧

        権限（CSV記載）: 管理者≧

        '
      operationId: deleteDevices
      parameters:
      - $ref: '#/components/parameters/deviceId'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteDevicesResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /devices/{deviceId}/alarm:
    get:
      tags:
      - devices
      summary: 故障アラーム
      description: 'ページ: デバイス一覧

        権限（CSV記載）: 一般≧

        '
      operationId: retrieveDevicesAlarm
      parameters:
      - $ref: '#/components/parameters/deviceId'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveDevicesAlarmResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
      - devices
      summary: 故障アラーム通知
      description: "ページ: 故障アラーム\n権限（CSV記載）: \n説明: デバイスが最新のアラーム状態（AlarmItem）を送信\n"
      operationId: createDevicesAlarm
      parameters:
      - $ref: '#/components/parameters/deviceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDevicesAlarmRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateDevicesAlarmResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /devices/{deviceId}/alarm/detail:
    get:
      tags:
      - devices
      summary: 故障アラーム（詳細）
      description: 'ページ: デバイス一覧

        権限（CSV記載）: 一般≧

        '
      operationId: retrieveDevicesAlarmDetail
      parameters:
      - $ref: '#/components/parameters/deviceId'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveDevicesAlarmDetailResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /devices/{deviceId}/battery:
    get:
      tags:
      - devices
      summary: バッテリー監視
      description: 'ページ: デバイス一覧

        権限（CSV記載）: 一般≧

        '
      operationId: retrieveDevicesBattery
      parameters:
      - $ref: '#/components/parameters/deviceId'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveDevicesBatteryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
      - devices
      summary: バッテリー状態送信
      description: "ページ: なし\n権限（CSV記載）: \n説明: デバイス→バックエンド\n"
      operationId: createDevicesBattery
      parameters:
      - $ref: '#/components/parameters/deviceId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateDevicesBatteryRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateDevicesBatteryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/amount/add:
    post:
      tags:
      - harvest
      summary: 収穫量の送信
      description: "ページ: 本日の収穫量の可視化\n権限（CSV記載）: \n説明: デバイスが前回送信以降の差分（インクリメント）をアップロード\nevent_id による冪等性を担保（重複は 409）\n"
      operationId: createHarvestAmountAdd
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateHarvestAmountAddRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateHarvestAmountAddResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/amount/daily:
    get:
      tags:
      - harvest
      summary: 日間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 日間収穫量の推移

        '
      operationId: listHarvestAmountDaily
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListHarvestAmountDailyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /harvest/amount/daily/category/{categoryId}:
    get:
      tags:
      - harvest
      summary: 仕分けサイズごとの 日間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 仕分けサイズごとの日間収穫量の推移

        '
      operationId: retrieveHarvestAmountDailyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveHarvestAmountDailyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
      - harvest
      summary: 仕分けサイズごとの 日間収穫量の変更
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 管理者≧

        説明: 仕分けサイズごとの日間収穫量（手動変更）

        クエリパラメータ date=YYYY-MM-DD を指定

        未指定の場合は当日（サーバー時刻）

        '
      operationId: partialUpdateHarvestAmountDailyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/date'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PartialUpdateHarvestAmountDailyCategoryRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartialUpdateHarvestAmountDailyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/amount/monthly:
    get:
      tags:
      - harvest
      summary: 月間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 月間収穫量の推移

        '
      operationId: listHarvestAmountMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListHarvestAmountMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /harvest/amount/monthly/category/{categoryId}:
    get:
      tags:
      - harvest
      summary: 仕分けサイズごとの 月間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 仕分けサイズごとの月間収穫量の推移

        '
      operationId: retrieveHarvestAmountMonthlyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveHarvestAmountMonthlyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
      - harvest
      summary: 仕分けサイズごとの 月間収穫量の変更
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 管理者≧

        説明: 仕分けサイズごとの月間収穫量の推移（手動変更）

        クエリパラメータ month=YYYY-MM を指定

        未指定の場合は今月（サーバー時刻）

        '
      operationId: partialUpdateHarvestAmountMonthlyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/month_ym'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PartialUpdateHarvestAmountMonthlyCategoryRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartialUpdateHarvestAmountMonthlyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/amount/weekly:
    get:
      tags:
      - harvest
      summary: 週間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 週間収穫量の推移

        '
      operationId: listHarvestAmountWeekly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListHarvestAmountWeeklyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /harvest/amount/weekly/category/{categoryId}:
    get:
      tags:
      - harvest
      summary: 仕分けサイズごとの 週間収穫量
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 一般≧

        説明: 仕分けサイズごとの週間収穫量の推移

        '
      operationId: retrieveHarvestAmountWeeklyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveHarvestAmountWeeklyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    patch:
      tags:
      - harvest
      summary: 仕分けサイズごとの 週間収穫量の変更
      description: 'ページ: 収穫量推移

        権限（CSV記載）: 管理者≧

        説明: 仕分けサイズごとの週間収穫量の推移（手動変更）

        クエリパラメータ date=YYYY-MM-DD を指定（その日を含む週を対象）

        未指定の場合は今週（サーバー時刻）

        '
      operationId: partialUpdateHarvestAmountWeeklyCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/date'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PartialUpdateHarvestAmountWeeklyCategoryRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartialUpdateHarvestAmountWeeklyCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/target/daily:
    put:
      tags:
      - harvest
      summary: 1日目標収穫量設定
      description: 'ページ: 目標設定

        権限（CSV記載）: 管理者≧

        説明: 1日あたりの目標収穫量を設定

        '
      operationId: updateHarvestTargetDaily
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHarvestTargetDailyRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateHarvestTargetDailyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/target/monthly:
    put:
      tags:
      - harvest
      summary: 月間目標収穫量設定
      description: 'ページ: 目標設定

        権限（CSV記載）: 管理者≧

        説明: 1か月あたりの目標収穫量を設定

        '
      operationId: updateHarvestTargetMonthly
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHarvestTargetMonthlyRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateHarvestTargetMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /harvest/target/weekly:
    put:
      tags:
      - harvest
      summary: 週間目標収穫量設定
      description: 'ページ: 目標設定

        権限（CSV記載）: 管理者≧

        説明: 1週間あたりの目標収穫量を設定

        '
      operationId: updateHarvestTargetWeekly
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHarvestTargetWeeklyRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateHarvestTargetWeeklyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /prices/category/{categoryId}:
    post:
      tags:
      - prices
      summary: 単価登録
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 指定年月の単価（円/個）を登録

        '
      operationId: createPricesCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePricesCategoryRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePricesCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
      - prices
      summary: 単価変更
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 指定年月の単価（円/個）を更新

        '
      operationId: updatePricesCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePricesCategoryRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdatePricesCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
      - prices
      summary: 単価削除
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: クエリパラメータ year, month で指定した単価を削除

        '
      operationId: deletePricesCategory
      parameters:
      - $ref: '#/components/parameters/categoryId'
      - $ref: '#/components/parameters/year'
      - $ref: '#/components/parameters/month'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeletePricesCategoryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /prices/monthly:
    get:
      tags:
      - prices
      summary: 単価一覧（月間）
      description: 'ページ: 売上推移

        権限（CSV記載）: 管理者≧

        説明: 月ごとの単価推移

        '
      operationId: listPricesMonthly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListPricesMonthlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /prices/yearly:
    get:
      tags:
      - prices
      summary: 単価一覧（年間）
      description: "ページ: 売上推移\n権限（CSV記載）: \n説明: 年間の単価推移（月平均）\n"
      operationId: listPricesYearly
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListPricesYearlyResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
  /users:
    get:
      tags:
      - users
      summary: ユーザー一覧
      description: 'ページ: ユーザー一覧

        権限（CSV記載）: 管理者≧

        '
      operationId: listUsers
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListUsersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
      parameters:
      - $ref: '#/components/parameters/page'
      - $ref: '#/components/parameters/page_size'
    post:
      tags:
      - users
      summary: ユーザー登録
      description: 'ページ: ユーザー登録

        権限（CSV記載）: 一般≧

        '
      operationId: createUsers
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUsersRequest'
      responses:
        '201':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateUsersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /users/{userId}:
    patch:
      tags:
      - users
      summary: ユーザー変更
      description: 'ページ: プロフィール

        権限（CSV記載）: 一般≧

        '
      operationId: partialUpdateUsers
      parameters:
      - $ref: '#/components/parameters/userId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PartialUpdateUsersRequest'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PartialUpdateUsersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
      - users
      summary: ユーザー削除
      description: 'ページ: ユーザー一覧

        権限（CSV記載）: 管理者≧

        '
      operationId: deleteUsers
      parameters:
      - $ref: '#/components/parameters/userId'
      responses:
        '200':
          description: 成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteUsersResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  parameters:
    categoryId:
      name: categoryId
      in: path
      required: true
      schema:
        type: string
        minLength: 1
        maxLength: 64
        example: S
      description: '収穫カテゴリ（仕分けサイズ等）のID。例: S'
    deviceId:
      name: deviceId
      in: path
      required: true
      schema:
        type: string
        minLength: 1
        maxLength: 64
        example: DEV001
        pattern: ^[A-Za-z0-9_-]+$
      description: 'デバイスID。例: DEV001'
    userId:
      name: userId
      in: path
      required: true
      schema:
        type: string
        format: uuid
        example: 550e8400-e29b-41d4-a716-446655440000
      description: ユーザーID（UUID）
    page:
      name: page
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        default: 1
      description: ページ番号（1始まり）
    page_size:
      name: page_size
      in: query
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 500
        default: 50
      description: 1ページあたりの件数
    date:
      name: date
      in: query
      required: false
      description: 基準日（YYYY-MM-DD）。未指定の場合は当日（サーバー時刻）。
      schema:
        type: string
        format: date
      example: '2025-12-21'
    month_ym:
      name: month
      in: query
      required: false
      description: 対象月（YYYY-MM）。未指定の場合は当月（サーバー時刻）
      schema:
        type: string
        pattern: ^\d{4}-\d{2}$
      example: 2025-12
    year:
      name: year
      in: query
      required: true
      description: 対象年（YYYY）
      schema:
        type: integer
        minimum: 2000
        maximum: 2100
      example: 2025
    month:
      name: month
      in: query
      required: true
      description: '対象月（MM: 1-12）'
      schema:
        type: integer
        minimum: 1
        maximum: 12
      example: 12
  responses:
    BadRequest:
      description: 不正なリクエスト（バリデーションエラー等）
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: 認証エラー（未認証/認証情報不正）
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Forbidden:
      description: 権限エラー（アクセス権限不足）
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFound:
      description: 対象IDが存在しない
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Conflict:
      description: 競合（event_id の重複）
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    InternalServerError:
      description: サーバー内部エラー
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
  schemas:
    ErrorDetail:
      type: object
      required:
      - field
      - reason
      - value
      properties:
        field:
          type: string
        reason:
          type: string
        value:
          description: 入力値（ログ用）。型はリクエストにより変わるため union で表現。
          nullable: true
          oneOf:
          - type: string
          - type: number
          - type: integer
          - type: boolean
          - type: object
          - type: array
    ErrorResponse:
      type: object
      required:
      - error
      properties:
        error:
          type: object
          required:
          - code
          - message
          - details
          - request_id
          properties:
            code:
              type: string
            message:
              type: string
            details:
              type: array
              description: 詳細情報。空配列可。
              items:
                $ref: '#/components/schemas/ErrorDetail'
            request_id:
              type: string
              description: 'リクエスト追跡ID。サーバーが発行する。推奨: req_<uuid>（例: req_550e8400-e29b-41d4-a716-446655440000）'
    CreateDefectsAmountAddResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/DefectsRecord'
        required:
        - data
      description: CreateDefectsAmountAddResponse（回答例を反映）
    CreateDefectsAmountAddRequest:
      type: object
      description: 不良品数追加リクエスト（デバイス→サーバー）（差分アップロード）
      properties:
        device_id:
          type: string
          example: DEV001
        category_id:
          type: string
          example: S
        count:
          type: integer
          minimum: 1
          example: 12
          description: 前回送信以降の差分（インクリメント）
        occurred_at:
          type: string
          format: date-time
          example: '2025-12-21T12:34:56+09:00'
          description: 計測時刻（timestamp）
        event_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      required:
      - event_id
      - device_id
      - category_id
      - count
      - occurred_at
      additionalProperties: false
    CreateDevicesResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/Device'
        required:
        - data
      description: CreateDevicesResponse（回答例を反映）
    CreateDevicesRequest:
      type: object
      description: デバイス登録リクエスト
      properties:
        id:
          type: string
          example: DEV001
          pattern: ^[A-Za-z0-9_-]+$
        name:
          type: string
          example: 収穫カウンタ1
        status:
          type: string
          enum:
          - active
          - inactive
          - maintenance
          example: active
          default: active
      required:
      - id
      - name
      additionalProperties: false
    CreateDevicesBatteryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/BatteryLatest'
        required:
        - data
      description: CreateDevicesBatteryResponse（回答例を反映）
    CreateDevicesBatteryRequest:
      type: object
      description: バッテリー状態通知リクエスト（デバイス→サーバー）
      additionalProperties: false
      properties:
        percent:
          type: integer
          minimum: 0
          maximum: 100
          example: 80
        is_charging:
          type: boolean
          example: false
        updated_at:
          type: string
          format: date-time
          example: '2025-12-21T12:34:56+09:00'
      required:
      - percent
      - is_charging
      - updated_at
    CreateHarvestAmountAddResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestRecord'
        required:
        - data
      description: CreateHarvestAmountAddResponse（回答例を反映）
    CreateHarvestAmountAddRequest:
      type: object
      description: 収穫数追加リクエスト（デバイス→サーバー）（差分アップロード）
      properties:
        device_id:
          type: string
          example: DEV001
        category_id:
          type: string
          example: S
        count:
          type: integer
          minimum: 1
          example: 12
          description: 前回送信以降の差分（インクリメント）
        occurred_at:
          type: string
          format: date-time
          example: '2025-12-21T12:34:56+09:00'
          description: 計測時刻（timestamp）
        event_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      required:
      - event_id
      - device_id
      - category_id
      - count
      - occurred_at
      additionalProperties: false
    CreatePricesCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PriceRecord'
        required:
        - data
      description: CreatePricesCategoryResponse（回答例を反映）
    CreatePricesCategoryRequest:
      type: object
      description: 単価登録リクエスト（円/個）
      additionalProperties: false
      properties:
        year:
          type: integer
          minimum: 2000
          maximum: 2100
          example: 2025
        month:
          type: integer
          minimum: 1
          maximum: 12
          example: 12
        unit_price_yen:
          type: integer
          minimum: 0
          example: 120
          description: 単価（円/個）
      required:
      - year
      - month
      - unit_price_yen
    CreateUsersResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/User'
        required:
        - data
      description: CreateUsersResponse（回答例を反映）
    CreateUsersRequest:
      type: object
      description: ユーザー登録リクエスト
      properties:
        email:
          type: string
          format: email
          example: user@example.com
        name:
          type: string
          example: 山田太郎
        password:
          type: string
          minLength: 8
          example: password1234
      required:
      - email
      - name
      - password
      additionalProperties: false
    DeleteDevicesResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/DeleteDevicesData'
        required:
        - data
      description: DeleteDevicesResponse（回答例を反映）
    DeletePricesCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/DeletePricesCategoryData'
        required:
        - data
      description: DeletePricesCategoryResponse（回答例を反映）
    DeleteUsersResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/DeleteUsersData'
        required:
        - data
      description: DeleteUsersResponse（回答例を反映）
    ListAnalyticsHarvestMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedForecastHarvestMonthly'
        required:
        - data
      description: ListAnalyticsHarvestMonthlyResponse（回答例を反映）
    ListAnalyticsRevenueMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedRevenueMonthly'
        required:
        - data
      description: ListAnalyticsRevenueMonthlyResponse（回答例を反映）
    ListDefectsAmountMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedDefectsAggregateMonthly'
        required:
        - data
      description: ListDefectsAmountMonthlyResponse（回答例を反映）
    ListDefectsAmountWeeklyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedDefectsAggregateWeekly'
        required:
        - data
      description: ListDefectsAmountWeeklyResponse（回答例を反映）
    ListDefectsRatioMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedDefectsRatioMonthly'
        required:
        - data
      description: ListDefectsRatioMonthlyResponse（回答例を反映）
    ListDefectsRatioWeeklyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedDefectsRatioWeekly'
        required:
        - data
      description: ListDefectsRatioWeeklyResponse（回答例を反映）
    ListDevicesResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedDevices'
        required:
        - data
      description: ListDevicesResponse（回答例を反映）
    ListHarvestAmountDailyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateDaily'
        required:
        - data
      description: ListHarvestAmountDailyResponse（回答例を反映）
    ListHarvestAmountMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateMonthly'
        required:
        - data
      description: ListHarvestAmountMonthlyResponse（回答例を反映）
    ListHarvestAmountWeeklyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateWeekly'
        required:
        - data
      description: ListHarvestAmountWeeklyResponse（回答例を反映）
    ListPricesMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedPriceMonthly'
        required:
        - data
      description: ListPricesMonthlyResponse（回答例を反映）
    ListPricesYearlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedPriceYearly'
        required:
        - data
      description: ListPricesYearlyResponse（回答例を反映）
    ListUsersResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedUsers'
        required:
        - data
      description: ListUsersResponse（回答例を反映）
    PartialUpdateHarvestAmountDailyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestAggregateDailyByCategoryItem'
        required:
        - data
      description: PartialUpdateHarvestAmountDailyCategoryResponse（回答例を反映）
    PartialUpdateHarvestAmountDailyCategoryRequest:
      type: object
      description: 手動変更（確定値で置換）
      additionalProperties: false
      properties:
        count:
          type: integer
          minimum: 0
          example: 123
          description: その期間の確定値（置換）
      required:
      - count
    PartialUpdateHarvestAmountMonthlyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestAggregateMonthlyByCategoryItem'
        required:
        - data
      description: PartialUpdateHarvestAmountMonthlyCategoryResponse（回答例を反映）
    PartialUpdateHarvestAmountMonthlyCategoryRequest:
      type: object
      description: 手動変更（確定値で置換）
      additionalProperties: false
      properties:
        count:
          type: integer
          minimum: 0
          example: 123
          description: その期間の確定値（置換）
      required:
      - count
    PartialUpdateHarvestAmountWeeklyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestAggregateWeeklyByCategoryItem'
        required:
        - data
      description: PartialUpdateHarvestAmountWeeklyCategoryResponse（回答例を反映）
    PartialUpdateHarvestAmountWeeklyCategoryRequest:
      type: object
      description: 手動変更（確定値で置換）
      additionalProperties: false
      properties:
        count:
          type: integer
          minimum: 0
          example: 123
          description: その期間の確定値（置換）
      required:
      - count
    PartialUpdateUsersResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/User'
        required:
        - data
      description: PartialUpdateUsersResponse（回答例を反映）
    PartialUpdateUsersRequest:
      type: object
      description: ユーザー更新リクエスト（本人用）
      properties:
        name:
          type: string
          example: 山田花子
      required: []
      additionalProperties: false
    RetrieveDevicesBatteryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/BatteryLatest'
        required:
        - data
      description: RetrieveDevicesBatteryResponse（回答例を反映）
    RetrieveHarvestAmountDailyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateDailyByCategory'
        required:
        - data
      description: RetrieveHarvestAmountDailyCategoryResponse（回答例を反映）
    RetrieveHarvestAmountMonthlyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateMonthlyByCategory'
        required:
        - data
      description: RetrieveHarvestAmountMonthlyCategoryResponse（回答例を反映）
    RetrieveHarvestAmountWeeklyCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedHarvestAggregateWeeklyByCategory'
        required:
        - data
      description: RetrieveHarvestAmountWeeklyCategoryResponse（回答例を反映）
    UpdateAdminUsersResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/User'
        required:
        - data
      description: UpdateAdminUsersResponse（回答例を反映）
    UpdateAdminUsersRequest:
      type: object
      description: ユーザー更新リクエスト（管理者用）
      properties:
        name:
          type: string
          example: 山田太郎
        role:
          type: string
          enum:
          - admin
          - viewer
          example: viewer
        is_active:
          type: boolean
          example: true
      required: []
      additionalProperties: false
    UpdateHarvestTargetDailyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestTarget'
        required:
        - data
      description: UpdateHarvestTargetDailyResponse（回答例を反映）
    UpdateHarvestTargetDailyRequest:
      type: object
      description: 目標収穫量設定更新リクエスト（daily）
      properties:
        target_count:
          type: integer
          minimum: 0
          example: 4000
        effective_from:
          type: string
          format: date
          nullable: true
          example: '2025-12-15'
      required:
      - target_count
      additionalProperties: false
    UpdateHarvestTargetMonthlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestTarget'
        required:
        - data
      description: UpdateHarvestTargetMonthlyResponse（回答例を反映）
    UpdateHarvestTargetMonthlyRequest:
      type: object
      description: 目標収穫量設定更新リクエスト（monthly）
      properties:
        target_count:
          type: integer
          minimum: 0
          example: 4000
        effective_from:
          type: string
          format: date
          nullable: true
          example: '2025-12-15'
      required:
      - target_count
      additionalProperties: false
    UpdateHarvestTargetWeeklyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/HarvestTarget'
        required:
        - data
      description: UpdateHarvestTargetWeeklyResponse（回答例を反映）
    UpdateHarvestTargetWeeklyRequest:
      type: object
      description: 目標収穫量設定更新リクエスト（weekly）
      properties:
        target_count:
          type: integer
          minimum: 0
          example: 4000
        effective_from:
          type: string
          format: date
          nullable: true
          example: '2025-12-15'
      required:
      - target_count
      additionalProperties: false
    UpdatePricesCategoryResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PriceRecord'
        required:
        - data
      description: UpdatePricesCategoryResponse（回答例を反映）
    UpdatePricesCategoryRequest:
      type: object
      description: 単価更新リクエスト（円/個）
      additionalProperties: false
      properties:
        year:
          type: integer
          minimum: 2000
          maximum: 2100
          example: 2025
        month:
          type: integer
          minimum: 1
          maximum: 12
          example: 12
        unit_price_yen:
          type: integer
          minimum: 0
          example: 120
          description: 単価（円/個）
      required:
      - year
      - month
      - unit_price_yen
    SuccessEnvelopeBase:
      type: object
      description: 成功レスポンスの共通ラッパー
      properties:
        status:
          type: string
          description: 処理結果
          example: success
        request_id:
          type: string
          description: 'リクエスト追跡ID。サーバーが発行する場合に付与。推奨: req_<uuid>'
          example: req_123456
        data: {}
      required:
      - status
      - data
      additionalProperties: false
    User:
      type: object
      description: ユーザー
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        email:
          type: string
          format: email
          example: user@example.com
        name:
          type: string
          example: 山田太郎
        role:
          type: string
          enum:
          - admin
          - viewer
          example: viewer
        is_active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
        updated_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - id
      - email
      - name
      - role
      - is_active
      - created_at
      - updated_at
      additionalProperties: false
    Device:
      type: object
      description: デバイス
      properties:
        id:
          type: string
          example: DEV001
        name:
          type: string
          example: 収穫カウンタ1
        status:
          type: string
          enum:
          - active
          - inactive
          - maintenance
          example: active
        created_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
        updated_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - id
      - name
      - status
      - created_at
      - updated_at
      additionalProperties: false
    BatteryLatest:
      type: object
      description: バッテリー最新状態
      properties:
        device_id:
          type: string
          example: DEV001
        percent:
          type: integer
          minimum: 0
          maximum: 100
          example: 80
        voltage_mv:
          type: integer
          example: 4100
          nullable: true
        is_charging:
          type: boolean
          example: false
        updated_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - device_id
      - percent
      - is_charging
      - updated_at
      additionalProperties: false
    AlarmItem:
      type: object
      description: アラーム（1件）
      properties:
        alarm_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        type:
          type: string
          enum:
          - battery_low
          - sensor_failure
          - network_error
          example: battery_low
        message:
          type: string
          example: バッテリー残量が低下しました
        status:
          type: string
          enum:
          - open
          - acknowledged
          - closed
          example: open
        occurred_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - alarm_id
      - type
      - message
      - status
      - occurred_at
      additionalProperties: false
    AlarmStatus:
      type: object
      description: アラームの最新状態
      properties:
        device_id:
          type: string
          example: DEV001
        has_active_alarm:
          type: boolean
          example: true
        severity:
          type: string
          enum:
          - info
          - warning
          - critical
          nullable: true
          example: warning
        last_alarm_at:
          type: string
          format: date-time
          nullable: true
          example: '2025-12-15T12:34:56+09:00'
        active_alarms:
          type: array
          items:
            $ref: '#/components/schemas/AlarmItem'
          nullable: true
      required:
      - device_id
      - has_active_alarm
      additionalProperties: false
    HarvestRecord:
      type: object
      description: 収穫記録（1件）
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        device_id:
          type: string
          example: DEV001
        category_id:
          type: string
          nullable: true
          example: S
        count:
          type: integer
          minimum: 1
          example: 12
        occurred_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
        created_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - id
      - device_id
      - count
      - occurred_at
      - created_at
      additionalProperties: false
    DefectsRecord:
      type: object
      description: 不良品記録（1件）
      properties:
        id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
        device_id:
          type: string
          example: DEV001
        category_id:
          type: string
          nullable: true
          example: S
        count:
          type: integer
          minimum: 1
          example: 2
        occurred_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
        created_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - id
      - device_id
      - count
      - occurred_at
      - created_at
      additionalProperties: false
    HarvestAggregateDailyItem:
      type: object
      description: 日別収穫集計（1日）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}-\d{2}$
          example: '2025-12-15'
        total_count:
          type: integer
          minimum: 0
          example: 4000
      required:
      - period
      - total_count
      additionalProperties: false
    HarvestAggregateWeeklyItem:
      type: object
      description: 週別収穫集計（1週）
      properties:
        period:
          type: string
          pattern: ^\d{4}-W\d{2}$
          example: 2025-W50
        total_count:
          type: integer
          minimum: 0
          example: 28000
      required:
      - period
      - total_count
      additionalProperties: false
    HarvestAggregateMonthlyItem:
      type: object
      description: 月別収穫集計（1月）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        total_count:
          type: integer
          minimum: 0
          example: 120000
      required:
      - period
      - total_count
      additionalProperties: false
    HarvestAggregateDailyByCategoryItem:
      type: object
      description: 日別×カテゴリ収穫集計（1件）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}-\d{2}$
          example: '2025-12-15'
        category_id:
          type: string
          example: S
        category_name:
          type: string
          nullable: true
          example: Sサイズ
        total_count:
          type: integer
          minimum: 0
          example: 1200
      required:
      - period
      - category_id
      - total_count
      additionalProperties: false
    HarvestAggregateWeeklyByCategoryItem:
      type: object
      description: 週別×カテゴリ収穫集計（1件）
      properties:
        period:
          type: string
          pattern: ^\d{4}-W\d{2}$
          example: 2025-W50
        category_id:
          type: string
          example: S
        category_name:
          type: string
          nullable: true
          example: Sサイズ
        total_count:
          type: integer
          minimum: 0
          example: 8000
      required:
      - period
      - category_id
      - total_count
      additionalProperties: false
    HarvestAggregateMonthlyByCategoryItem:
      type: object
      description: 月別×カテゴリ収穫集計（1件）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        category_id:
          type: string
          example: S
        category_name:
          type: string
          nullable: true
          example: Sサイズ
        total_count:
          type: integer
          minimum: 0
          example: 35000
      required:
      - period
      - category_id
      - total_count
      additionalProperties: false
    HarvestTarget:
      type: object
      description: 目標収穫量設定
      properties:
        target_type:
          type: string
          enum:
          - daily
          - weekly
          - monthly
          example: daily
        target_count:
          type: integer
          minimum: 0
          example: 4000
        effective_from:
          type: string
          format: date
          nullable: true
          example: '2025-12-15'
        updated_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - target_type
      - target_count
      - updated_at
      additionalProperties: false
    DefectsAggregateMonthlyItem:
      type: object
      description: 月別不良品数（1月）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        total_defects:
          type: integer
          minimum: 0
          example: 120
      required:
      - period
      - total_defects
      additionalProperties: false
    DefectsAggregateWeeklyItem:
      type: object
      description: 週別不良品数（1週）
      properties:
        period:
          type: string
          pattern: ^\d{4}-W\d{2}$
          example: 2025-W50
        total_defects:
          type: integer
          minimum: 0
          example: 30
      required:
      - period
      - total_defects
      additionalProperties: false
    DefectsRatioMonthlyItem:
      type: object
      description: 月別不良品割合（1月）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        defects_ratio_percent:
          type: number
          minimum: 0
          maximum: 100
          example: 2.5
        total_defects:
          type: integer
          minimum: 0
          example: 120
        total_harvest:
          type: integer
          minimum: 0
          example: 4800
      required:
      - period
      - defects_ratio_percent
      - total_defects
      - total_harvest
      additionalProperties: false
    DefectsRatioWeeklyItem:
      type: object
      description: 週別不良品割合（1週）
      properties:
        period:
          type: string
          pattern: ^\d{4}-W\d{2}$
          example: 2025-W50
        defects_ratio_percent:
          type: number
          minimum: 0
          maximum: 100
          example: 1.1
        total_defects:
          type: integer
          minimum: 0
          example: 30
        total_harvest:
          type: integer
          minimum: 0
          example: 2700
      required:
      - period
      - defects_ratio_percent
      - total_defects
      - total_harvest
      additionalProperties: false
    PriceRecord:
      type: object
      description: 単価（カテゴリ別）
      properties:
        category_id:
          type: string
          example: S
        unit_price_yen:
          type: integer
          minimum: 0
          example: 120
        effective_from:
          type: string
          format: date
          nullable: true
          example: '2025-12-01'
        effective_to:
          type: string
          format: date
          nullable: true
          example: '2025-12-31'
        updated_at:
          type: string
          format: date-time
          example: '2025-12-15T12:34:56+09:00'
      required:
      - category_id
      - unit_price_yen
      - updated_at
      additionalProperties: false
    PriceMonthlyItem:
      type: object
      description: 月間単価（表示用）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        category_id:
          type: string
          example: S
        unit_price_yen:
          type: integer
          minimum: 0
          example: 120
      required:
      - period
      - category_id
      - unit_price_yen
      additionalProperties: false
    PriceYearlyItem:
      type: object
      description: 年間単価（表示用）
      properties:
        period:
          type: string
          pattern: ^\d{4}$
          example: '2025'
        category_id:
          type: string
          example: S
        unit_price_yen:
          type: integer
          minimum: 0
          example: 120
      required:
      - period
      - category_id
      - unit_price_yen
      additionalProperties: false
    ForecastHarvestMonthlyItem:
      type: object
      description: 月間収穫量予測（1月）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2026-01
        predicted_count:
          type: integer
          minimum: 0
          example: 110000
        ci_low_count:
          type: integer
          minimum: 0
          nullable: true
          example: 100000
        ci_high_count:
          type: integer
          minimum: 0
          nullable: true
          example: 120000
        model_version:
          type: string
          nullable: true
          example: v1.0.0
      required:
      - period
      - predicted_count
      additionalProperties: false
    RevenueMonthlyItem:
      type: object
      description: 月間売上（1月）
      properties:
        period:
          type: string
          pattern: ^\d{4}-\d{2}$
          example: 2025-12
        revenue_yen:
          type: integer
          minimum: 0
          example: 1200000
      required:
      - period
      - revenue_yen
      additionalProperties: false
    RevenueYearlyItem:
      type: object
      description: 年間売上（1年）
      properties:
        period:
          type: string
          pattern: ^\d{4}$
          example: '2025'
        revenue_yen:
          type: integer
          minimum: 0
          example: 14000000
      required:
      - period
      - revenue_yen
      additionalProperties: false
    PaginatedUsers:
      type: object
      description: ユーザー一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/User'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedDevices:
      type: object
      description: デバイス一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Device'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedAlarmItems:
      type: object
      description: アラーム一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AlarmItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedForecastHarvestMonthly:
      type: object
      description: 月間収穫量予測一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ForecastHarvestMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedRevenueMonthly:
      type: object
      description: 月間売上一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/RevenueMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedRevenueYearly:
      type: object
      description: 年間売上一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/RevenueYearlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedDefectsAggregateMonthly:
      type: object
      description: 月別不良品数一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DefectsAggregateMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedDefectsAggregateWeekly:
      type: object
      description: 週別不良品数一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DefectsAggregateWeeklyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedDefectsRatioMonthly:
      type: object
      description: 月別不良品割合一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DefectsRatioMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedDefectsRatioWeekly:
      type: object
      description: 週別不良品割合一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DefectsRatioWeeklyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateDaily:
      type: object
      description: 日別収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateDailyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateWeekly:
      type: object
      description: 週別収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateWeeklyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateMonthly:
      type: object
      description: 月別収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateDailyByCategory:
      type: object
      description: 日別×カテゴリ収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateDailyByCategoryItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateWeeklyByCategory:
      type: object
      description: 週別×カテゴリ収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateWeeklyByCategoryItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedHarvestAggregateMonthlyByCategory:
      type: object
      description: 月別×カテゴリ収穫集計一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/HarvestAggregateMonthlyByCategoryItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedPriceMonthly:
      type: object
      description: 月間単価一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/PriceMonthlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    PaginatedPriceYearly:
      type: object
      description: 年間単価一覧（ページング）
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/PriceYearlyItem'
        page:
          type: integer
          minimum: 1
          example: 1
        page_size:
          type: integer
          minimum: 1
          example: 50
        total:
          type: integer
          minimum: 0
          example: 123
      required:
      - items
      - page
      - page_size
      - total
      additionalProperties: false
    DeleteDevicesData:
      type: object
      description: デバイス削除結果
      properties:
        deleted:
          type: boolean
          example: true
        device_id:
          type: string
          example: DEV001
      required:
      - deleted
      - device_id
      additionalProperties: false
    DeleteUsersData:
      type: object
      description: ユーザー削除結果
      properties:
        deleted:
          type: boolean
          example: true
        user_id:
          type: string
          format: uuid
          example: 550e8400-e29b-41d4-a716-446655440000
      required:
      - deleted
      - user_id
      additionalProperties: false
    DeletePricesCategoryData:
      type: object
      description: 単価カテゴリ削除結果
      properties:
        deleted:
          type: boolean
          example: true
        category_id:
          type: string
          example: S
      required:
      - deleted
      - category_id
      additionalProperties: false
    CreateDevicesAlarmRequest:
      $ref: '#/components/schemas/AlarmItem'
    CreateDevicesAlarmResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/AlarmItem'
        required:
        - data
      description: CreateDevicesAlarmResponse（回答例を反映）
    RetrieveDevicesAlarmResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/AlarmStatus'
        required:
        - data
      description: RetrieveDevicesAlarmResponse（回答例を反映）
    RetrieveDevicesAlarmDetailResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedAlarmItems'
        required:
        - data
      description: RetrieveDevicesAlarmDetailResponse（回答例を反映）
    ListAnalyticsRevenueYearlyResponse:
      allOf:
      - $ref: '#/components/schemas/SuccessEnvelopeBase'
      - type: object
        properties:
          data:
            $ref: '#/components/schemas/PaginatedRevenueYearly'
        required:
        - data
      description: ListAnalyticsRevenueYearlyResponse（回答例を反映）
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: 'JWT Bearer token. Authorization: Bearer <access_token>'
security:
- bearerAuth: []
